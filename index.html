<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Quiz Sécurité Incendie</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Couleur pour Android (Chrome) -->
  <meta name="theme-color" content="#00d4ff">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Préchargement de quelques images critiques -->
  <link rel="preload" as="image" href="images/wall.png">
  <link rel="preload" as="image" href="images/wall2.png">
  <link rel="preload" as="image" href="images/correct.png">
  <link rel="preload" as="image" href="images/incorrect.png">
  <link rel="preload" as="image" href="images/decor1.gif">
  <link rel="preload" as="image" href="images/decor2.gif">
  <link rel="preload" as="image" href="images/fire empty.png">
  <link rel="preload" as="image" href="images/fire full.png">
  <link rel="preload" as="image" href="images/ryu.gif">
  <link rel="preload" as="image" href="images/ken.gif">
  <link rel="preload" as="image" href="images/ryu2.png">
  <link rel="preload" as="image" href="images/ken2.png">
  <link rel="preload" as="image" href="images/mute-off.gif">
  <link rel="preload" as="image" href="images/mute-on.gif">
  <link rel="preload" as="image" href="images/perfect.gif">
  <link rel="preload" as="image" href="images/tryagain.png">
  <link rel="preload" as="image" href="images/youwin.png">
  <link rel="preload" as="image" href="images/lose1.gif">
  <link rel="preload" as="image" href="images/lose2.gig">
  
  <style>
    /* Vos styles existants restent inchangés */
    @keyframes victoryAnimation {
      0% { transform: scale(1) rotate(0deg); }
      20% { transform: scale(1.1) rotate(3deg); }
      40% { transform: scale(1) rotate(-3deg); }
      60% { transform: scale(1.1) rotate(3deg); }
      80% { transform: scale(1) rotate(-3deg); }
      90% { transform: scale(1) rotate(0deg); }
      100% { transform: scale(1) rotate(0deg); }
    }
    .victory-animation {
      animation: victoryAnimation 2s ease-in-out infinite;
      transform-origin: center;
    }
    @keyframes windmillShake {
      0% { transform: rotate(0deg); }
      15% { transform: rotate(15deg); }
      30% { transform: rotate(-15deg); }
      45% { transform: rotate(10deg); }
      60% { transform: rotate(-10deg); }
      75% { transform: rotate(5deg); }
      90% { transform: rotate(-5deg); }
      100% { transform: rotate(0deg); }
    }
    .windmill-shake {
      animation: windmillShake 0.8s ease-in-out forwards !important;
      transform-origin: center;
    }
    @keyframes levitateLeft {
      0%   { transform: translate(40px, 0px); }
      50%  { transform: translate(40px, -10px); }
      100% { transform: translate(40px, 0px); }
    }
    @keyframes levitateRight {
      0%   { transform: translate(-40px, 0px); }
      50%  { transform: translate(-40px, -10px); }
      100% { transform: translate(-40px, 0px); }
    }
    @keyframes shake {
      0% { transform: translate(0, 0); }
      10% { transform: translate(-10px, -10px); }
      20% { transform: translate(10px, 10px); }
      30% { transform: translate(-10px, 10px); }
      40% { transform: translate(10px, -10px); }
      50% { transform: translate(-10px, -10px); }
      60% { transform: translate(10px, 10px); }
      70% { transform: translate(-10px, 10px); }
      80% { transform: translate(10px, -10px); }
      90% { transform: translate(-10px, -10px); }
      100% { transform: translate(0, 0); }
    }
    @keyframes popAnimation {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }
    @keyframes blink {
      0% { opacity: 1; }
      50% { opacity: 0; }
      100% { opacity: 1; }
    }
    @keyframes glow-green {
      0% { box-shadow: 0 0 5px rgba(0,255,0,0.7); }
      50% { box-shadow: 0 0 20px rgba(0,255,0,0.9); }
      100% { box-shadow: 0 0 5px rgba(0,255,0,0.7); }
    }
    @keyframes borderGlow {
      0%, 100% { box-shadow: 0 0 5px 2px white; }
      50% { box-shadow: 0 0 20px 2px white; }
    }
    @keyframes borderGlow2 {
      0%, 100% { box-shadow: 0 0 5px 2px rgba(255,0,0,0.7); }
      50% { box-shadow: 0 0 20px 2px rgba(255,0,0,0.7); }
    }
    @keyframes borderGlowGreen {
      0%, 100% { box-shadow: 0 0 5px 2px rgba(0,255,0,0.7); }
      50% { box-shadow: 0 0 20px 2px rgba(0,255,0,0.7); }
    }
    @keyframes floatAnimation {
      0%   { transform: translateY(0); }
      50%  { transform: translateY(-10px); }
      100% { transform: translateY(0); }
    }
    .floating-title {
      position: relative;
      z-index: 3;
      animation: floatAnimation 8s ease-in-out infinite;
      display: block;
      margin: -10px auto 10px;
      max-width: 90%;
      width: auto;
    }
    .pikachu {
      display: block;
      margin: 0 auto;
      transform: translateY(19px)!important;
      transform: translateX(-3px);
      width: 210px !important;
      height: 192px !important;
    }
    #result-header {
      display: block;
      margin: 0 auto 20px;
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: linear-gradient(90deg, rgba(2,0,36,1) 0%, rgba(9,94,121,1) 0%, rgba(0,212,255,1) 100%);
      background-size: 100% 100%;
      animation: quizBGAnimation 10s ease infinite;
    }
    body {
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .container {
      width: 360px;
      max-width: 90%;
      background: url('images/wall.png') no-repeat center center;
      background-size: cover;
      border: 3px solid black;
      border-radius: 15px;
      text-align: center;
      padding: 30px;
      margin: 20px auto;
      transition: transform 0.3s ease;
      position: relative;
    }
    /* Page d'accueil */
    #home { width: 360px; }
    #start-btn {
      display: flex;
      justify-content: center;
      align-items: center;
      transform: translateY(20px);
      width: 140px;
      height: 80px;
      margin: 20px auto;
      padding: 5px 10px;
      font-size: 18px;
      cursor: pointer;
      background: linear-gradient(135deg, #2196F3, #0D47A1);
      color: white;
      font-weight: bold;
      border: 3px solid white;
      border-radius: 10px;
      text-shadow: 1px 1px 2px black;
      transition: transform 0.1s ease-in-out;
      position: relative;
      top: 25px;
      overflow: visible;
    }
    #start-btn:active {
      transform: translateY(20px) scale(0.95);
      animation: glow-green 1.5s infinite ease-in-out, blink 0.3s infinite ease-in-out;
    }
    #start-btn img {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 140px;
      height: auto;
      pointer-events: none;
    }
    /* Bouton INDEX pour page d'accueil – petit et placé sous le bouton commencer */
    #home-index-btn {
      width: 80px;
      height: 40px;
      transform: translateY(-240px);
      font-size: 14px;
      margin: 0px auto;
      display: block;
      cursor: pointer;
      background: linear-gradient(to top, black, gray);
      color: white;
      font-weight: bold;
      border: 2px solid white;
      border-radius: 10px;
      text-shadow: 1px 1px 2px black;
      transition: transform 0.1s ease-in-out;
       animation: borderGlow 2s ease-in-out infinite;

    }
    #home-index-btn:active {
transform: translateY(-240px) scale(0.95);
    }
    /* Zone du quiz */
    #quiz-container {
      background: linear-gradient(135deg, #4CAF50, #81C784);
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
      text-align: center;
      display: none;
    }
    #question-counter {
      font-weight: bold;
      margin-bottom: 5px;
      font-family: Arial, sans-serif;
      color: white;
      margin-top: -20px;
      margin-bottom: 0px;
    }
    #question-text {
      width: 95%;
      margin: 0 auto;
      font-family: 'Arial Black', Arial, sans-serif;
      font-weight: bold;
      font-size: 22px;
      margin-bottom: 15px;
      color: white;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      line-height: 1.5;
    }
    .options {
      font-family: Arial, sans-serif;
      font-weight: normal;
      font-size: 18px;
      color: white;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      text-align: left;
      margin: 0;
      margin-bottom: 30px;
      margin-left: 20px;
      padding-left: 20px;
    }
    .option {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      margin-bottom: 10px;
    }
    .option input[type="checkbox"] { display: none; }
    .option label { display: inline-flex; align-items: center; }
    .option label:before {
      content: "";
      display: inline-block;
      width: 40px;
      height: 40px;
      margin-right: 8px;
      margin-left: -50px;
      background: url('images/fire empty.png') no-repeat center;
      background-size: contain;
      flex-shrink: 0;
    }
    .option input[type="checkbox"]:checked + label:before {
      background: url('images/fire full.png') no-repeat center;
      background-size: contain;
      width: 40px;
      height: 40px;
    }
    #validate-btn {
      font-weight: bold;
      margin: 0 auto;
      margin-top: 30px;
      display: block;
      padding: 15px 25px;
      font-size: 25px;
      border: 3px solid #08ff08;
      border-radius: 10px;
      background-color: #1a1d21;
      color: white;
      cursor: pointer;
      transition: transform 0.1s ease, box-shadow 0.1s ease;
      animation: borderGlow 2s ease-in-out infinite;
    }
    #validate-btn:active { transform: translateY(2px) scale(0.98); }
    #result { margin-top: 20px; }
    .result-image {
      width: 60px;
      display: block;
      margin: 10px auto;
    }
    .incorrect-answer-text {
      color: red;
      font-size: 20px;
      font-weight: bold;
      font-family: 'Arial Black', Arial, sans-serif;
      text-shadow: -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff, 1px 1px 0 #fff, 3px 3px 5px black;
      margin-bottom: 10px;
      margin-top: 5px;
    }
    .incorrect-answer-header {
      margin-top: 0px;
      font-weight: bold;
      font-size: 18px;
      font-family: 'Arial Black', Arial, sans-serif;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      color: white;
    }
    .correct-container {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: -30px;
    }
    .correct-decoration { width: 60px; }
    .correct-container .result-image.correct {
      animation: popAnimation 0.5s ease-out;
      width: 80px;
      margin-bottom: 25px;
      z-index: 1;
    }
    .result-image.incorrect {
      width: 80px;
      margin-top: 25px;
      animation: shake 0.5s ease-in-out;
    }
    /* Page finale */
    #result-page {  
      background: linear-gradient(135deg, #2196F3, #0D47A1);
      display: none; 
      position: relative;
      border: 3px solid white;
    }
    #result-page h2 { font-size: 24px; margin-bottom: 20px; }
    #final-score {
      margin-top: -15px;
      margin-bottom: 15px;
      font-weight: bold;
      font-size: 25px;
      font-family: 'Arial Black', Arial, sans-serif;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      color: #00ff1a;
    }
    #restart-btn {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 160px;
      height: 65px;
      margin: 20px auto;
      padding: 5px 20px;
      font-size: 18px;
      cursor: pointer;
      background: linear-gradient(to top, black, gray);
      color: white;
      font-weight: bold;
      border: 2px solid white;
      border-radius: 10px;
      text-shadow: 1px 1px 2px black;
      transition: transform 0.1s ease-in-out;
      position: relative;
      overflow: visible;
      animation: borderGlow2 2s ease-in-out infinite;
      z-index: 6; 
    }
    #restart-btn:active { transform: scale(0.95); }
    /* Bouton INDEX sur la page de résultats – même style petit */
    #result-index-btn {
      width: 80px;
      height: 40px;
      font-size: 14px;
      margin: 10px auto 0;
      display: block;
      cursor: pointer;
      background: linear-gradient(to top, black, gray);
      color: white;
      font-weight: bold;
      border: 2px solid white;
      border-radius: 10px;
      text-shadow: 1px 1px 2px black;
      transition: transform 0.1s ease-in-out;
      animation: borderGlow 2s ease-in-out infinite;
    }
    #result-index-btn:active {
      transform: scale(0.95);
    }
    .incorrect-container {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: -40px;
    }
    .decor-leftX, .decor-rightX {
      width: 80px;
      padding: 12px 0;
    }
    .decor-rightX {
      width: 80px;
      transform: translate(-30px, 3px);
      z-index: 0;
      padding: 12px 0px;
      animation: levitateRightX 1s ease-in-out infinite;
    }
    .decor-leftX {
      width: 80px;
      transform: translate(30px, 3px);
      z-index: 0;
      padding: 12px 0px;
      animation: levitateLeftX 1s ease-in-out infinite;
    }
    .decor-right {
      width: 80px;
      transform: translate(-40px, -10px);
      z-index: 0;
      padding: 12px 0px;
    }
    .decor-left {
      width: 80px;
      transform: translate(40px, -10px);
      z-index: 0;
      padding: 12px 0px;
    }
    @keyframes levitateLeftX {
      0%   { transform: translate(40px, 3px); }
      50%  { transform: translate(40px, 13px); }
      100% { transform: translate(40px, 3px); }
    }
    @keyframes levitateRightX {
      0%   { transform: translate(-40px, 3px); }
      50%  { transform: translate(-40px, 13px); }
      100% { transform: translate(-40px, 3px); }
    }
    .centipod {
      display: block;
      margin: 0 auto;
    }
    .vidget {
      display: block;
      margin: 0 auto;
    }
    /* ======= Styles pour le modal INDEX ======= */
    #index-modal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.5);
      padding: 20px;
      border-radius: 15px;
      z-index: 1000;
      text-align: center;
      width: 300px;
      max-width: 80%;
    }
    #index-modal .index-option {
      width: 60px;
      height: 60px;
      margin: 0 10px;
      font-size: 18px;
      border: 2px solid white;
      border-radius: 50%;
      background: linear-gradient(to top, black, gray);
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.1s ease-in-out;
    }
    #index-modal .index-option:active {
      transform: scale(0.95);
    }
    #index-modal #close-index-modal {
      margin-top: 20px;
      padding: 8px 16px;
      font-size: 16px;
      border: 2px solid white;
      border-radius: 5px;
      background: linear-gradient(to top, black, gray);
      color: white;
      cursor: pointer;
      transition: transform 0.1s ease-in-out;
    }
    /* ==================================================== */
    
    @media (max-width: 480px) {
      .container {       
        width: 360px;
        max-width: 90%;
        padding: 30px;
      }
      #overlay {
        top: 85px !important;
        left: 50% !important;
        transform: translateX(-50%) !important;
      }
      #question-text { font-size: 18px; }
      #final-score { font-size: 20px; }
      .floating-title { margin: 0 auto 0px; }
      .pikachu {
        display: block;
      }
      .startu { border-radius: 10px; }
      .incorrect-container {
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .again {
        display: block;
        margin: 0 auto 0px;
      }
      @keyframes windmillShake {
        0% { transform: rotate(0deg); }
        15% { transform: rotate(15deg); }
        30% { transform: rotate(-15deg); }
        45% { transform: rotate(10deg); }
        60% { transform: rotate(-10deg); }
        75% { transform: rotate(5deg); }
        90% { transform: rotate(-5deg); }
        100% { transform: rotate(0deg); }
      }
      .windmill-shake {
        animation: windmillShake 0.8s ease-in-out forwards !important;
        transform-origin: center;
      }
      .raised {
        transform: translateY(-20px);
        margin-bottom: -10px !important;
      }
      @keyframes victoryAnimation {
        0% { transform: scale(1) rotate(0deg); }
        20% { transform: scale(1.1) rotate(3deg); }
        40% { transform: scale(1) rotate(-3deg); }
        60% { transform: scale(1.1) rotate(3deg); }
        80% { transform: scale(1) rotate(-3deg); }
        90% { transform: scale(1) rotate(0deg); }
        100% { transform: scale(1) rotate(0deg); }
      }
      .victory-animation {
        animation: victoryAnimation 2s ease-in-out infinite;
        transform-origin: center;
      }
      @media (max-width: 480px) {
        .pikachu {
          display: block;
          margin: 0 auto;
          width: 290px;
          height: 215px;
        }
      }
      @media (max-width: 480px) {
        .again {
          width: 85%;
          margin: 0 auto;
          transform: translateX(0px);
        }
      }
      @media (max-width: 480px) {      
        #result-header {
          display: block;
          margin: 0 auto 50px !important;
          width: 85%;
        }
      }
      @media (max-width: 480px) {
        #final-score {
          font-size: 28px !important;
        }
      }
    }
  </style>
</head>
<body>
  <!-- Éléments audio -->
  <audio id="checkbox-sound" src="audio/select.mp3" preload="auto"></audio>
  <audio id="start-sound" src="audio/start.mp3" preload="auto"></audio>
  <audio id="correct-sound" src="audio/correct.mp3" preload="auto"></audio>
  <audio id="incorrect-sound" src="audio/incorrect.mp3" preload="auto"></audio>
  <audio id="incorrect-sound2" src="audio/incorrect2.mp3" preload="auto"></audio>
  <audio id="perfect-sound" src="audio/perfect.mp3" preload="auto"></audio>
  <audio id="imperfect-sound" src="audio/imperfect.mp3" preload="auto"></audio>
  
  <!-- Page d'accueil -->
  <div class="container" id="home">
    <!-- Titre centré -->
    <img src="images/titre.png" alt="quiz ssiap1" class="floating-title">
    <img src="images/vidget.gif" alt="videx" class="vidget" style="display: block; margin: 40px auto; position: relative; top: -30px;">
    <!-- Image décorative centrée -->
    <img src="images/decor.gif" alt="pik" class="pikachu" style="display: none; z-index: 3;">
    <!-- Image GBC (non overlay) -->
    <img src="images/GBC.png" alt="GBC" style="display: none; margin: -200px auto 0 auto; border: 3px solid black; width: 290px; height: auto; position: relative; z-index: 2;">
    <!-- Bouton mute, bouton start et bouton INDEX (petit) -->
    <img id="mute-btn" src="images/mute-off.gif" alt="Son activé" style="cursor: pointer; width: 30px; height: 25px; margin-bottom: 20px; margin-top: 25px;">
    <button id="start-btn"><img src="images/start.png" style="margin-bottom: -30px; width: 120px"></button>
    <button id="home-index-btn">INDEX</button>
  </div>
  
  <!-- Zone du quiz -->
  <div class="container" id="quiz-container">
    <div id="question-counter">Question 1 / 3</div>
    <div id="question-text">[Texte de la question]</div>
    <div class="options" id="options">
      <!-- Les options seront générées dynamiquement -->
    </div>
    <button id="validate-btn">Valider</button>
    <div id="result"></div>
  </div>
  
  <!-- Page de résultats finale -->
  <div class="container" id="result-page">
    <img id="result-header" src="images/tryagain.png" alt="encore" class="again">
    <img id="final-image" src="images/lose1.gif" alt="Résultat" style="width:120px; display:block; margin: -15px auto 20px;">
    <p id="final-score">Score : 0 sur 3</p>
    <button id="restart-btn" style="text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;">RECOMMENCER</button>
    <!-- Bouton INDEX ajouté sur la page de résultats -->
    <button id="result-index-btn">INDEX</button>
  </div>
  
  <!-- Modal INDEX -->
  <div id="index-modal">
    <button class="index-option" data-url="https://remi-mason.github.io/quiz-1/">1</button>
    <button class="index-option" data-url="https://remi-mason.github.io/quiz-1-2/">2</button>
    <button class="index-option" data-url="https://remi-mason.github.io/quiz-1-3/">3</button>
    <br>
    <button id="close-index-modal">Fermer</button>
  </div>
  
  <script>
    // (Code JavaScript existant inchangé sauf ajout des écouteurs pour le bouton INDEX sur la page de résultats)
    document.addEventListener("DOMContentLoaded", function() {
      var decorImage = document.querySelector('.pikachu');
      if (decorImage) {
        decorImage.src = "images/decor1.gif";
        decorImage.style.width = "235px";
        setTimeout(function(){
          decorImage.src = "images/decor2.gif";
          decorImage.style.width = "235px";
        }, 5000);
      }
    });
    
    // Données du quiz
    const quizData = [
 {
        "question": "Qui est considéré comme public dans un ERP ?",
        "options": [
            "Toute personne admise dans l’établissement, y compris le personnel",
            "Uniquement les clients et visiteurs",
            "Seules les personnes extérieures à l’entreprise",
            "Les employés uniquement pendant les horaires d’ouverture",
            "Les propriétaires de l’établissement",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Toute personne admise dans l’établissement, y compris le personnel"
        ]
    },
    {
        "question": "Quels types de locaux ne sont pas considérés comme des ERP ?",
        "options": [
            "Les locaux assimilables à un domicile privé",
            "Les locaux strictement réservés aux travailleurs",
            "Les magasins et centres commerciaux",
            "Les salles de spectacles ouvertes au public",
            "Les établissements de soins médicaux",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Les locaux assimilables à un domicile privé",
            "Les locaux strictement réservés aux travailleurs"
        ]
    },
    {
        "question": "Sur quels critères sont classés les ERP ?",
        "options": [
            "En types selon la nature de l’exploitation",
            "En catégories selon l’effectif du public et du personnel",
            "En fonction de la couleur des bâtiments",
            "Uniquement selon la superficie des locaux",
            "Selon la nature juridique du propriétaire",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "En types selon la nature de l’exploitation",
            "En catégories selon l’effectif du public et du personnel"
        ]
    },
	{
 "question": "Qu’est-ce qu’un établissement recevant du public (ERP) ?",
    "options": [
        "Un bâtiment où le public est admis librement ou avec une participation",
        "Un local strictement réservé aux employés de l’établissement",
        "Un lieu où sont organisées des réunions ouvertes au public",
        "Un domicile privé utilisé occasionnellement pour des réunions",
        "Un espace réservé uniquement aux administrations publiques",
        "Aucune des réponses"
    ],
    "correctAnswers": [
        "Un bâtiment où le public est admis librement ou avec une participation",
        "Un lieu où sont organisées des réunions ouvertes au public"
    ]
},
    {
        "question": "Quel type d'ERP correspond aux structures d’accueil pour personnes âgées et personnes handicapées ?",
        "options": [
            "Type J",
            "Type L",
            "Type M",
            "Type N",
            "Type O",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type J"
        ]
    },
    {
        "question": "Quel type d'ERP concerne les salles d’auditions, de conférences, de réunions, de spectacles ou polyvalentes ?",
        "options": [
            "Type J",
            "Type L",
            "Type M",
            "Type N",
            "Type O",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type L"
        ]
    },
    {
        "question": "Quel type d'ERP regroupe les magasins de vente et centres commerciaux ?",
        "options": [
            "Type M",
            "Type N",
            "Type O",
            "Type P",
            "Type R",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type M"
        ]
    },
    {
        "question": "Quel type d'ERP regroupe les restaurants et débits de boissons ?",
        "options": [
            "Type N",
            "Type O",
            "Type P",
            "Type R",
            "Type S",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type N"
        ]
    },
    {
        "question": "Quel type d'ERP correspond aux hôtels et pensions de famille ?",
        "options": [
            "Type O",
            "Type P",
            "Type R",
            "Type S",
            "Type T",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type O"
        ]
    },
    {
        "question": "Quel type d'ERP est associé aux salles de danse et salles de jeux ?",
        "options": [
            "Type P",
            "Type R",
            "Type S",
            "Type T",
            "Type U",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type P"
        ]
    },
    {
        "question": "Quel type d'ERP inclut les établissements d'éveil, d'enseignement, de formation, centres de vacances et centres de loisirs sans hébergement ?",
        "options": [
            "Type R",
            "Type S",
            "Type T",
            "Type U",
            "Type V",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type R"
        ]
    },
    {
        "question": "Quel type d'ERP regroupe les bibliothèques et centres de documentation ?",
        "options": [
            "Type S",
            "Type T",
            "Type U",
            "Type V",
            "Type W",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type S"
        ]
    },
    {
        "question": "Quel type d'ERP concerne les salles d'expositions ?",
        "options": [
            "Type T",
            "Type U",
            "Type V",
            "Type W",
            "Type X",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type T"
        ]
    },
    {
        "question": "Quel type d'ERP inclut les établissements sanitaires ?",
        "options": [
            "Type U",
            "Type V",
            "Type W",
            "Type X",
            "Type Y",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type U"
        ]
    },
    {
        "question": "Quel type d'ERP correspond aux établissements de culte ?",
        "options": [
            "Type V",
            "Type W",
            "Type X",
            "Type Y",
            "Type PA",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type V"
        ]
    },
    {
        "question": "Quel type d'ERP regroupe les administrations, banques et bureaux ?",
        "options": [
            "Type W",
            "Type X",
            "Type Y",
            "Type PA",
            "Type CTS",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type W"
        ]
    },
    {
        "question": "Quel type d'ERP concerne les établissements sportifs couverts ?",
        "options": [
            "Type X",
            "Type Y",
            "Type PA",
            "Type CTS",
            "Type SG",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type X"
        ]
    },
    {
        "question": "Quel type d'ERP correspond aux musées ?",
        "options": [
            "Type Y",
            "Type PA",
            "Type CTS",
            "Type SG",
            "Type PS",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type Y"
        ]
    },
    {
        "question": "Quel type d'ERP regroupe les établissements de plein air ?",
        "options": [
            "Type PA",
            "Type CTS",
            "Type SG",
            "Type PS",
            "Type GA",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type PA"
        ]
    },
    {
        "question": "Quel type d'ERP inclut les chapiteaux, tentes et structures ?",
        "options": [
            "Type CTS",
            "Type SG",
            "Type PS",
            "Type GA",
            "Type OA",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type CTS"
        ]
    },
    {
        "question": "Quel type d'ERP regroupe les structures gonflables ?",
        "options": [
            "Type SG",
            "Type PS",
            "Type GA",
            "Type OA",
            "Type EF",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type SG"
        ]
    },
    {
        "question": "Quel type d'ERP concerne les parcs de stationnement couverts ?",
        "options": [
            "Type PS",
            "Type GA",
            "Type OA",
            "Type EF",
            "Type REF",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type PS"
        ]
    },
    {
        "question": "Quel type d'ERP regroupe les gares ?",
        "options": [
            "Type GA",
            "Type OA",
            "Type EF",
            "Type REF",
            "Type J",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type GA"
        ]
    },
    {
        "question": "Quel type d'ERP concerne les hôtels-restaurants d’altitude ?",
        "options": [
            "Type OA",
            "Type EF",
            "Type REF",
            "Type J",
            "Type L",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type OA"
        ]
    },
    {
        "question": "Quel type d'ERP correspond aux établissements flottants ?",
        "options": [
            "Type EF",
            "Type REF",
            "Type J",
            "Type L",
            "Type M",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type EF"
        ]
    },
    {
        "question": "Quel type d'ERP correspond aux refuges de montagne ?",
        "options": [
            "Type REF",
            "Type J",
            "Type L",
            "Type M",
            "Type N",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "Type REF"
        ]
    },
	
    {
        "question": "Quelle catégorie d'ERP concerne les établissements pouvant accueillir plus de 1500 personnes ?",
        "options": [
            "1ʳᵉ catégorie",
            "2ᵉ catégorie",
            "3ᵉ catégorie",
            "4ᵉ catégorie",
            "5ᵉ catégorie",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "1ʳᵉ catégorie"
        ]
    },
    {
        "question": "Quelle catégorie d'ERP concerne les établissements accueillant entre 701 et 1500 personnes ?",
        "options": [
            "1ʳᵉ catégorie",
            "2ᵉ catégorie",
            "3ᵉ catégorie",
            "4ᵉ catégorie",
            "5ᵉ catégorie",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "2ᵉ catégorie"
        ]
    },
    {
        "question": "Quelle catégorie d'ERP concerne les établissements accueillant entre 301 et 700 personnes ?",
        "options": [
            "1ʳᵉ catégorie",
            "2ᵉ catégorie",
            "3ᵉ catégorie",
            "4ᵉ catégorie",
            "5ᵉ catégorie",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "3ᵉ catégorie"
        ]
    },
    {
        "question": "Quelle catégorie d'ERP concerne les établissements accueillant jusqu'à 300 personnes (sauf exception) ?",
        "options": [
            "1ʳᵉ catégorie",
            "2ᵉ catégorie",
            "3ᵉ catégorie",
            "4ᵉ catégorie",
            "5ᵉ catégorie",
            "Aucune des réponses"
        ],
        "correctAnswers": [
            "4ᵉ catégorie"
        ]
    }
    ];
    
    let currentQuestion = 0;
    let score = 0;
    let isMuted = false;
    
    // Références aux éléments
    const homeDiv = document.getElementById("home");
    const quizContainer = document.getElementById("quiz-container");
    const resultPage = document.getElementById("result-page");
    const questionCounterEl = document.getElementById("question-counter");
    const questionTextEl = document.getElementById("question-text");
    const optionsDiv = document.getElementById("options");
    const resultDiv = document.getElementById("result");
    const finalScoreEl = document.getElementById("final-score");
    const finalImage = document.getElementById("final-image");
    
    const startBtn = document.getElementById("start-btn");
    const validateBtn = document.getElementById("validate-btn");
    const restartBtn = document.getElementById("restart-btn");
    const muteBtn = document.getElementById("mute-btn");
    
    const checkboxSound = document.getElementById("checkbox-sound");
    const startSound = document.getElementById("start-sound");
    const correctSound = document.getElementById("correct-sound");
    const incorrectSound = document.getElementById("incorrect-sound");
    
    // Fonction de basculement mute
    function muteToggleHandler() {
      isMuted = !isMuted;
      [startSound, correctSound, incorrectSound, checkboxSound,
       document.getElementById("incorrect-sound2"),
       document.getElementById("perfect-sound"),
       document.getElementById("imperfect-sound")
      ].forEach(audio => { audio.muted = isMuted; });
      if (isMuted) {
        this.src = "images/mute-on.gif";
        this.alt = "Son désactivé";
      } else {
        this.src = "images/mute-off.gif";
        this.alt = "Son activé";
      }
    }
    muteBtn.addEventListener("click", muteToggleHandler);
    document.addEventListener("DOMContentLoaded", function() {
      var muteImg = document.getElementById("mute-btn");
      if (muteImg && muteImg.src.indexOf(".gif") !== -1) {
        var newMuteImg = muteImg.cloneNode(true);
        newMuteImg.src = newMuteImg.src.split('?')[0] + '?t=' + new Date().getTime();
        muteImg.parentNode.replaceChild(newMuteImg, muteImg);
        newMuteImg.addEventListener("click", muteToggleHandler);
      }
    });
    
    // Démarrage du quiz
    startBtn.addEventListener("click", () => {
      if (screen.orientation && screen.orientation.lock) {
        screen.orientation.lock("portrait").catch(error => { console.log("Le verrouillage de l'orientation a échoué :", error); });
      }
      startSound.play();
      startBtn.style.boxShadow = "0 0 20px rgba(0, 255, 0, 1)";
      startBtn.style.animation = "blink 0.3s infinite ease-in-out";
      setTimeout(() => {
        startBtn.style.animation = "glow-green 1.5s infinite ease-in-out";
        homeDiv.style.display = "none";
        quizContainer.style.display = "block";
        currentQuestion = 0;
        score = 0;
        showQuestion();
      }, 2000);
    });
    
    // Affichage de la question
    function showQuestion() {
      resultDiv.innerHTML = "";
      const data = quizData[currentQuestion];
      questionCounterEl.textContent = `${currentQuestion + 1} / ${quizData.length}`;
      questionTextEl.textContent = data.question;
      optionsDiv.innerHTML = "";
      data.options.forEach((option, index) => {
        const div = document.createElement("div");
        div.className = "option";
        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.value = option;
        checkbox.name = "option";
        checkbox.id = `option_${index}`;
        checkbox.addEventListener("click", () => { 
          checkboxSound.currentTime = 0; 
          checkboxSound.play(); 
        });
        const label = document.createElement("label");
        label.htmlFor = `option_${index}`;
        label.textContent = option;
        div.appendChild(checkbox);
        div.appendChild(label);
        optionsDiv.appendChild(div);
      });
    }
    
    // Comparaison des tableaux
    function arraysEqual(a, b) {
      if (a.length !== b.length) return false;
      const sortedA = a.slice().sort();
      const sortedB = b.slice().sort();
      return sortedA.every((val, index) => val === sortedB[index]);
    }
    
    const incorrectSound2 = document.getElementById("incorrect-sound2");
    validateBtn.addEventListener("click", () => {
      const data = quizData[currentQuestion];
      const selected = Array.from(document.querySelectorAll('input[name="option"]:checked')).map(el => el.value);
      if (selected.length === 0) { 
        alert("Veuillez sélectionner au moins une réponse"); 
        return; 
      }
      const isCorrect = arraysEqual(selected, data.correctAnswers);
      validateBtn.style.display = "none";
      
      if (isCorrect) {
        score++;
        correctSound.currentTime = 0;
        correctSound.play();
        resultDiv.innerHTML = 
          `<div class="correct-container">
             <img src="images/ryu.gif" alt="Décoration gauche" class="decor-left">
             <img src="images/correct.png" alt="Bonne réponse" class="result-image correct">
             <img src="images/ken.gif" alt="Décoration droite" class="decor-right">
           </div>`;
        
        setTimeout(() => {
          currentQuestion++;
          if (currentQuestion < quizData.length) {
            showQuestion();
            validateBtn.style.display = "block";
          } else {
            showResultPage();
          }
        }, 2000);
        
      } else {
        const selectedSound = (Math.random() < 0.5) ? incorrectSound : incorrectSound2;
        selectedSound.currentTime = 0;
        selectedSound.play();
        resultDiv.innerHTML = 
          `<div class="incorrect-container">
             <img src="images/ryu2.png" alt="Décoration gauche" class="decor-leftX">
             <img src="images/incorrect.png" alt="Mauvaise réponse" class="result-image incorrect">
             <img src="images/ken2.png" alt="Décoration droite" class="decor-rightX">
           </div>
           <div id="next-button-placeholder"></div>
           <div class="incorrect-answer-header">Réponse :</div>
           <div class="incorrect-answer-text">${data.correctAnswers.join(", ")}</div>`;
        
        setTimeout(() => {
          const incorrectContainer = document.querySelector(".incorrect-container");
          if (incorrectContainer) {
            incorrectContainer.innerHTML = "";
          }
          
          const nextPlaceholder = document.getElementById("next-button-placeholder");
          if (nextPlaceholder) {
            nextPlaceholder.style.marginBottom = "10px";
            const nextBtn = document.createElement("button");
            nextBtn.id = "next-btn";
            nextBtn.textContent = "Suivant";
            nextBtn.style.fontWeight = "bold";
            nextBtn.style.margin = "0 auto";
            nextBtn.style.marginTop = "30px";
            nextBtn.style.display = "block";
            nextBtn.style.padding = "15px 25px";
            nextBtn.style.fontSize = "25px";
            nextBtn.style.border = "3px solid #08ff08";
            nextBtn.style.borderRadius = "10px";
            nextBtn.style.backgroundColor = "#1a1d21";
            nextBtn.style.color = "white";
            nextBtn.style.cursor = "pointer";
            nextBtn.style.transition = "transform 0.1s ease, box-shadow 0.1s ease";
            nextBtn.style.animation = "borderGlow 2s ease-in-out infinite";
            
            nextPlaceholder.appendChild(nextBtn);
            
            nextBtn.addEventListener("click", () => {
              nextBtn.remove();
              currentQuestion++;
              if (currentQuestion < quizData.length) {
                showQuestion();
                validateBtn.style.display = "block";
              } else {
                showResultPage();
              }
            });
          }
        }, 2000);
      }
    });
    
    function showResultPage() {
      quizContainer.style.display = "none";
      resultPage.style.display = "block";
      const resultHeader = document.getElementById("result-header");
      if (score === quizData.length) {
        restartBtn.style.animation = "borderGlowGreen 2s ease-in-out infinite";
        resultPage.style.background = "linear-gradient(135deg, #2196F3, #0D47A1)";
        resultHeader.src = "images/youwin.png";
        resultHeader.style.transform = "translateX(0)";
        resultHeader.style.marginTop = "10px";
        resultHeader.classList.add("victory-animation");
        finalScoreEl.style.color = "#00ff1a";
        finalImage.classList.add("raised");
        finalImage.style.width = (window.innerWidth <= 480) ? "150px" : "190px";
        
        if (!document.getElementById("confet-overlay")) {
          let overlay = document.createElement("img");
          overlay.id = "confet-overlay";
          overlay.src = "images/confet.gif"; 
          overlay.alt = "Overlay de victoire";
          overlay.style.position = "absolute";
          overlay.style.top = "0";
          overlay.style.left = "0";
          overlay.style.width = "100%";
          overlay.style.height = "100%";
          overlay.style.objectFit = "cover";
          overlay.style.zIndex = "5";
          resultPage.appendChild(overlay);
        }
      } else {
        restartBtn.style.animation = "borderGlow2 2s ease-in-out infinite";
        resultPage.style.background = "black";
        resultHeader.src = "images/tryagain.png";
        resultHeader.style.transform = "translateX(0)";
        resultHeader.style.marginTop = "10px";
        finalScoreEl.style.color = "red";
        resultHeader.classList.add("windmill-shake");
        finalImage.classList.remove("raised");
        finalImage.style.width = "190px";
        finalImage.style.transform = "";
        setInterval(() => {
          resultHeader.classList.remove("windmill-shake");
          void resultHeader.offsetWidth;
          resultHeader.classList.add("windmill-shake");
        }, 2800);
      }
      resultPage.style.backgroundSize = "cover";
      resultPage.style.backgroundPosition = "center";
      finalScoreEl.textContent = `Score : ${score} sur ${quizData.length}`;
      finalImage.src = (score === quizData.length)
        ? "images/perfect.gif"
        : ((Math.random() < 0.5) ? "images/lose1.gif" : "images/lose2.gif");
      
      if (finalImage.src.indexOf("lose1.gif") !== -1 && window.innerWidth <= 480) {
        finalImage.style.transform = "translateY(-10px)";
      } else {
        finalImage.style.transform = "";
      }
      
      if (score === quizData.length) {
        document.getElementById("perfect-sound").currentTime = 0;
        document.getElementById("perfect-sound").play();
      } else {
        document.getElementById("imperfect-sound").currentTime = 0;
        document.getElementById("imperfect-sound").play();
      }
    }
    
    restartBtn.addEventListener("click", () => { window.location.reload(); });
    document.addEventListener("DOMContentLoaded", function() {
      var vidget = document.querySelector('.vidget');
      if (vidget) {
        vidget.src = "images/vidget.gif?t=" + new Date().getTime();
      }
    });
    
    /* Gestion du modal INDEX pour les deux boutons */
    document.addEventListener("DOMContentLoaded", function(){
      const indexModal = document.getElementById("index-modal");
      const closeIndexModal = document.getElementById("close-index-modal");
      const homeIndexBtn = document.getElementById("home-index-btn");
      const resultIndexBtn = document.getElementById("result-index-btn");
      
      if(homeIndexBtn){
        homeIndexBtn.addEventListener("click", function(){
          indexModal.style.display = "block";
        });
      }
      
      if(resultIndexBtn){
        resultIndexBtn.addEventListener("click", function(){
          indexModal.style.display = "block";
        });
      }
      
      if(closeIndexModal){
        closeIndexModal.addEventListener("click", function(){
          indexModal.style.display = "none";
        });
      }
      
      const indexOptions = document.querySelectorAll("#index-modal .index-option");
      indexOptions.forEach(button => {
        button.addEventListener("click", function(){
          window.location.href = button.dataset.url;
        });
      });
    });
  </script>
</body>
</html>
